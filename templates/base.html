{% load static %}
<!DOCTYPE html>
<html lang="bg">
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">

    {# Safe fallbacks #}
    {% with scheme=request.scheme|default:"https" host=request.get_host|default:"example.com" %}

        {# === Primary SEO === #}
        <title>{% block meta_title %}Излекувах се от шум в ушите | Книга „Живот без шум“ – Филип
            Стоянов{% endblock %}</title>
        <meta name="description"
              content="{% block meta_description %}Автобиографичната книга „Живот без шум“ от Филип Стоянов – лична история, решения и надежда за лечение и премахване на шума в ушите.{% endblock %}">
        <meta name="keywords"
              content="{% block meta_keywords %}излекувах се от шум в ушите, премахване на шум в ушите, шум в ушите лечение, шум в ушите причини, как се лекува шум в ушите{% endblock %}">
        <link rel="canonical"
              href="{% block meta_canonical %}{{ scheme }}://{{ host }}{{ request.path|default:'/' }}{% endblock %}">

        {# === Open Graph === #}
        <meta property="og:type" content="{% block og_type %}website{% endblock %}">
        <meta property="og:site_name" content="Живот без шум">
        <meta property="og:title"
              content="{% block og_title %}Излекувах се от шум в ушите | Книга „Живот без шум“ – Филип Стоянов{% endblock %}">
        <meta property="og:description"
              content="{% block og_description %}Автобиографичната книга „Живот без шум“ от Филип Стоянов – лична история, решения и надежда за лечение и премахване на шума в ушите.{% endblock %}">
        <meta property="og:url"
              content="{% block og_url %}{{ scheme }}://{{ host }}{{ request.path|default:'/' }}{% endblock %}">
        <meta property="og:image"
              content="{% block og_image %}{{ scheme }}://{{ host }}{% static 'images/og-default.jpg' %}{% endblock %}">
        <meta property="og:locale" content="bg_BG">

        {# === Twitter === #}
        <meta name="twitter:card" content="summary_large_image">
        <meta name="twitter:title"
              content="{% block twitter_title %}Излекувах се от шум в ушите | Книга „Живот без шум“ – Филип Стоянов{% endblock %}">
        <meta name="twitter:description"
              content="{% block twitter_description %}Автобиографичната книга „Живот без шум“ от Филип Стоянов – лична история, решения и надежда за лечение и премахване на шума в ушите.{% endblock %}">
        <meta name="twitter:image" content="
                {% block twitter_image %}{{ scheme }}://{{ host }}{% static 'images/og-default.jpg' %}{% endblock %}">


        {# === Minimal favicon (no pack needed yet) === #}
        <link rel="icon" type="image/svg+xml" href="{% static 'favicons/favicon.svg' %}">

        {# === JSON-LD (Book) === #}
        <script type="application/ld+json">
            {
              "@context": "https://schema.org",
              "@type": "Book",
              "name": "Живот без шум",
              "alternateName": "Излекувах се от шум в ушите",
              "author": { "@type": "Person", "name": "Филип Стоянов" },
              "inLanguage": "bg",
              "description": "Автобиографичната книга „Живот без шум“ от Филип Стоянов – лична история, решения и надежда за лечение и премахване на шума в ушите.",
              "image": ["{{ scheme }}://{{ host }}{% static 'images/og-default.jpg' %}"],
    "url": "{{ scheme }}://{{ host }}{{ request.path|default:'/' }}",
    "publisher": { "@type": "Organization", "name": "Живот без шум" }
  }
        </script>

    {% endwith %}

    {# === Fonts & CSS (yours) === #}
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link rel="stylesheet" type="text/css" href="//fonts.googleapis.com/css?family=Playfair+Display">
    <link rel="stylesheet" type="text/css" href="//fonts.googleapis.com/css?family=Nunito">
    <link rel="icon" type="image/svg+xml" href="{% static 'favicons/favicon.svg' %}">
    <link rel="stylesheet" href="{% static 'css/styles.css' %}">
</head>
<body>

<!-- ===== Mobile header ===== -->
<header class="mobile-header" aria-label="Мобилна навигация">
    <div class="container mobile-bar">
        <a class="brand" href="/">Живот без шум</a>
        <a class="btn buy" href="{% url 'checkout_info' %}">Купи</a>
        <button class="mobile-toggle" aria-expanded="false" aria-controls="mobile-drawer" aria-label="Отвори меню">☰
        </button>
    </div>
    <nav id="mobile-drawer" class="mobile-drawer" hidden>
        <a class="nav-link mobile" href="/#about">За книгата</a>
        <a class="nav-link mobile" href="/#author">За Автора</a>
        <a class="nav-link mobile" href="/#toc">Откъс</a>
        <a class="nav-link mobile" href="/#target">За кого е</a>
        <a class="nav-link mobile" href="/#usefull">Полезно</a>
    </nav>
</header>

<!-- ===== Desktop header (your existing one) ===== -->
<header class="site-header split">
    <div class="container nav">
        <a class="brand" href="/">Живот без шум</a>
        <nav class="nav-links">
            <a class="nav-link mobile" href="/#about">За книгата</a>
            <a class="nav-link mobile" href="/#author">За Автора</a>
            <a class="nav-link mobile" href="/#toc">Откъс</a>
            <a class="nav-link mobile" href="/#target">За кого е</a>
            <a class="nav-link mobile" href="/#usefull">Полезно</a>
            <a class="btn buy" href="{% url 'checkout_info' %}">Купи</a>
        </nav>
    </div>
</header>

{% block content %}{% endblock %}

<footer class="site-footer pro-footer">
    <div class="container footer-wrap">
        <nav class="footer-nav">
            <a href="/#about">За книгата</a>
            <a href="/#author">За автора</a>
            <a href="#">Отзиви</a>
            <a href="/#target">За кого е</a>
            <a href="/#usefull">Полезно</a>
        </nav>

        <nav class="footer-legal">
            <a href="#">Общи условия</a>
            <a href="#">Политика на поверителност</a>
            <a href="#">Условия за доставка</a>
            <a href="#">Политики за връщане</a>
        </nav>

        <div class="footer-socials" aria-label="социални профили">
            <a href="https://www.youtube.com/@filyaka7065" aria-label="YouTube" class="social" target="_blank"
               rel="noopener noreferrer">
                <svg viewBox="0 0 24 24" width="18" height="18" fill="currentColor" aria-hidden="true">
                    <path d="M23.5 6.2a4 4 0 0 0-2.8-2.8C18.8 3 12 3 12 3s-6.8 0-8.7.4A4 4 0 0 0 .5 6.2 41 41 0 0 0 0 12a41 41 0 0 0 .5 5.8 4 4 0 0 0 2.8 2.8C5.2 21 12 21 12 21s6.8 0 8.7-.4a4 4 0 0 0 2.8-2.8A41 41 0 0 0 24 12a41 41 0 0 0-.5-5.8zM9.7 15.6V8.4L16 12l-6.3 3.6z"/>
                </svg>
            </a>
            <a href="https://www.instagram.com/filyaka/?hl=bg" aria-label="Instagram" class="social" target="_blank"
               rel="noopener noreferrer">
                <svg viewBox="0 0 24 24" width="18" height="18" fill="currentColor" aria-hidden="true">
                    <path d="M12 7a5 5 0 1 0 0 10 5 5 0 0 0 0-10zm0-5C8.7 2 8.3 2 7.1 2.1 5.9 2.2 5 2.5 4.2 3.3 3.4 4.1 3.1 5 3 6.2 3 7.4 3 7.8 3 12s0 4.6.1 5.8c.1 1.2.4 2.1 1.2 2.9.8.8 1.7 1.1 2.9 1.2 1.2.1 1.6.1 5.8.1s4.6 0 5.8-.1c1.2-.1 2.1-.4 2.9-1.2.8-.8 1.1-1.7 1.2-2.9.1-1.2.1-1.6.1-5.8s0-4.6-.1-5.8c-.1-1.2-.4-2.1-1.2-2.9C20.9 2.5 20 2.2 18.8 2.1 17.6 2 17.2 2 12 2zm0 3c4.2 0 4.6 0 5.7.1.9.1 1.3.2 1.6.4.4.2.7.5.9.9.2.3.3.7.4 1.6.1 1.1.1 1.5.1 5.7s0 4.6-.1 5.7c-.1.9-.2 1.3-.4 1.6-.2.4-.5.7-.9.9-.3.2-.7.3-1.6.4-1.1.1-1.5.1-5.7.1s-4.6 0-5.7-.1c-.9-.1-1.3-.2-1.6-.4a2.3 2.3 0 0 1-.9-.9c-.2-.3-.3-.7-.4-1.6C3 16.6 3 16.2 3 12s0-4.6.1-5.7c.1-.9.2-1.3.4-1.6.2-.4.5-.7.9-.9.3-.2.7-.3 1.6-.4C7.4 5 7.8 5 12 5zm0 2.5A4.5 4.5 0 1 0 16.5 12 4.5 4.5 0 0 0 12 7.5zm5.8-1.5a1 1 0 1 0 1 1 1 1 0 0 0-1-1z"/>
                </svg>
            </a>
            <a href="https://www.facebook.com/Philip.Filyaka.Stoyanov/?locale=bg_BG" aria-label="Facebook"
               class="social" target="_blank" rel="noopener noreferrer">
                <svg viewBox="0 0 24 24" width="18" height="18" fill="currentColor" aria-hidden="true">
                    <path d="M22 12a10 10 0 1 0-11.6 9.9v-7h-2v-3h2v-2.3c0-2 1.2-3.1 3-3.1.9 0 1.8.1 1.8.1v2h-1c-1 0-1.3.6-1.3 1.2V12h2.2l-.3 3h-1.9v7A10 10 0 0 0 22 12z"/>
                </svg>
            </a>
            <a href="https://www.linkedin.com/in/philip-stoyanov-a0a0a0a1/" aria-label="LinkedIn" class="social"
               target="_blank" rel="noopener noreferrer">
                <svg viewBox="0 0 24 24" width="18" height="18" fill="currentColor" aria-hidden="true">
                    <path d="M4.98 3.5C4.98 4.88 3.86 6 2.5 6S0 4.88 0 3.5 1.12 1 2.5 1 4.98 2.12 4.98 3.5zM.5 8h4V23h-4V8zm7 0h3.8v2.1h.1c.5-1 1.9-2.1 3.9-2.1 4.2 0 5 2.8 5 6.4V23h-4v-7.2c0-1.7 0-3.9-2.4-3.9s-2.8 1.8-2.8 3.8V23h-4V8z"/>
                </svg>
            </a>
        </div>

        <hr class="footer-rule">

        <div class="footer-copy">
            <div>© 2025 Живот без шум. Всички права запазени</div>
            <div class="muted">Дизайн и разработка Modify</div>
        </div>
    </div>
</footer>

<script>
    // Checkout address/office toggle (unchanged)
    document.addEventListener("change", function (e) {
        if (e.target && e.target.name === "delivery_method") {
            const v = e.target.value;
            const address = document.querySelector("[data-address]");
            const office = document.querySelector("[data-office]");
            if (address && office) {
                if (v === "address") {
                    address.style.display = "grid";
                    office.style.display = "none";
                } else {
                    address.style.display = "none";
                    office.style.display = "grid";
                }
            }
        }
    });

    // Open socials externally (unchanged)
    document.querySelectorAll('.footer-socials a').forEach(a => {
        a.target = '_blank';
        a.rel = 'noopener noreferrer';
    });

    // ===== Mobile drawer toggle (☰ → ✕) =====
    (function () {
        const btn = document.querySelector('.mobile-toggle');
        const drawer = document.getElementById('mobile-drawer');
        if (!btn || !drawer) return;

        const open = () => {
            drawer.hidden = false;
            btn.setAttribute('aria-expanded', 'true');
            btn.setAttribute('aria-label', 'Затвори меню');
            btn.textContent = '✕';
            document.body.style.overflow = 'hidden';
        };

        const close = () => {
            btn.setAttribute('aria-expanded', 'false');
            btn.setAttribute('aria-label', 'Отвори меню');
            btn.textContent = '☰';
            document.body.style.overflow = '';
            drawer.hidden = true;
        };

        btn.addEventListener('click', (e) => {
            e.preventDefault();
            (btn.getAttribute('aria-expanded') === 'true') ? close() : open();
        });

        document.addEventListener('keydown', (e) => {
            if (e.key === 'Escape' && btn.getAttribute('aria-expanded') === 'true') close();
        });

        drawer.addEventListener('click', (e) => {
            if (e.target.tagName === 'A') close();
        });
    })();
</script>
</body>
</html>
